install mailx and postfix on server

What Is mailx? (Mail User Agent ‚Äì MUA)
mailx = Mail sending command / Email client

mailx provides the mail command, which lets YOU send mail from the terminal or scripts.

‚úî Command-line tool to compose/send emails
‚úî Used in automation scripts
‚úî Used to test mail delivery
‚úî Works on top of Postfix


Postfix = Mail Server / Mail Delivery Engine

Postfix is responsible for sending the email OUT from your Linux server.

‚úî Sends emails to Gmail, Outlook, SMTP servers
‚úî Handles queueing, retries, authentication
‚úî Encrypts mail using TLS
‚úî Receives mail (if configured)

Think of Postfix as the ‚Äúdelivery boy‚Äù who actually takes the letter and delivers it.

Pre-checks :-
-----------

1) - Check DNS resolution  ---> nslookup smtp.gmail.com
2) - Check connectivity using telnet --> telnet smtp.gmail.com 587 25 2525 465
3) - Check connectivity using nc  --> Need to install nmap-ncat, but only that:
     a) yum install -y nmap-ncat
     b) nc -v smtp.gmail.com 587


Installing and configuring part:-
---------------------------------
‚úÖ Step-1 :‚Äî yum install -y mailx postfix

‚úÖ Step-2 :‚Äî vim /etc/postfix/main.cf ( In our current org they are defining only inet_protocols and relay host rest are already defined)

inet_protocols = ipv4
relayhost = [smtp.gmail.com]:587

smtp_use_tls = yes
smtp_tls_security_level = encrypt
smtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt

smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
smtp_sasl_security_options = noanonymous

‚úÖ Step-3 :‚Äî Create your Gmail password file

sudo vi /etc/postfix/sasl_passwd
chmod 600 /etcpostfix/sasl_passwd

[smtp.gmail.com]:587 jagadeeshyeddula90888@gmail.com:kxshyxlslxzrtyqx

YOUR_APP_PASSWORD :-- generate from the below link ( if it is gmail for my personal use if it is for company not required)

https://myaccount.google.com/apppasswords

‚úÖ Step-4 :‚Äî

sudo postmap /etc/postfix/sasl_passwd (here we will get some duplicates comment them )

sudo systemctl restart postfix
echo "Gmail SMTP working!" | mail -s "Test Email" jagadeeshyeddula90888@gmail.com

‚úÖ Step-5 :‚Äî To delete previous mails
   postqueue -f

METHOD 1 (RECOMMENDED): Delete ALL queued mails

Use this after fixing SMTP issues.

postsuper -d ALL

‚úÖ METHOD 2: Delete a SPECIFIC mail (best practice)

If you want to delete only one mail:

postsuper -d 5ECC3A43E3


(Replace with actual Queue ID)

‚úÖ METHOD 3: Delete ALL deferred mails only
postsuper -d ALL deferred


some times it may not work use the below command and create new password and check it will work

The REAL fix (this is what changed)
‚úÖ We did three critical actions together
1Ô∏è‚É£ Rebuilt the SASL database properly
rm -f /etc/postfix/sasl_passwd.db
postmap /etc/postfix/sasl_passwd


üìå This ensured:

No stale .db

No mismatch between text and hash

Postfix reads fresh credentials


